# Basketball Data System - –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

## üéØ –¶–µ–ª—å

–°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –±–∞—Å–∫–µ—Ç–±–æ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–µ—Ç—Ç–∏–Ω–≥–∞

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

basketball_system/
‚îú‚îÄ‚îÄ üèóÔ∏è data-collector/ # –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
‚îÇ ‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÅ api/
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ basketball_api.py # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÅ models/
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ basketball_models.py # –ú–æ–¥–µ–ª–∏ –ë–î
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÅ storage/
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ database.py # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ë–î
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ üìÅ repositories/
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ base.py # –ë–∞–∑–æ–≤—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ async_base.py # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –±–∞–∑–∞
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ league_repository.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ team_repository.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ game_repository.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ player_repository.py
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ alias_repository.py # –î–ª—è –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤ –∫–æ–º–∞–Ω–¥?
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÅ services/
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ data_orchestrator.py # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–±–æ—Ä–∞
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ üìÅ utils/ # –£—Ç–∏–ª–∏—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ league_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ team_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ game_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ player_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ season_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ country_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ h2h_utils.py # Head-to-head
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ statistics_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ team_stats_utils.py
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ player_stats_utils.py
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ main.py # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ test_api.py # –¢–µ—Å—Ç—ã API
‚îÇ ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ ‚îî‚îÄ‚îÄ alembic.ini # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ
‚îú‚îÄ‚îÄ üìä analytics-engine/ # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ ML
‚îÇ ‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.py
‚îÇ ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ
‚îú‚îÄ‚îÄ üìà visualization-api/ # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ ‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ main.py
‚îÇ ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ
‚îú‚îÄ‚îÄ üîó shared/ # –û–±—â–∏–µ –º–æ–¥—É–ª–∏
‚îÇ ‚îú‚îÄ‚îÄ models.py # –û–±—â–∏–µ –º–æ–¥–µ–ª–∏ Pydantic?
‚îÇ ‚îî‚îÄ‚îÄ utils.py # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ project_structure.txt

## üèõÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –†–ï–®–ï–ù–ò–Ø

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π:

- **SQLAlchemy –º–æ–¥–µ–ª–∏** (`database.py`) - –¥–ª—è –ë–î
- **Pydantic —Å—Ö–µ–º—ã** (`basketball_models.py`) - –¥–ª—è API

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:

- –í—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ API –≤—ã–∑–æ–≤—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è asyncpg –¥–ª—è PostgreSQL

### –ú–æ–¥–µ–ª–∏ API (Pydantic)

**–§–∞–π–ª:** `data-collector/src/models/basketball_models.py`

–°—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ API –æ—Ç–≤–µ—Ç–æ–≤

–î–∞–π–¥–∂–µ—Å—Ç: basketball_models.py

üèóÔ∏è –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
python
class APIResponse(BaseModel):
"""–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –≤—Å–µ—Ö API –æ—Ç–≤–µ—Ç–æ–≤"""
get: str # –ú–µ—Ç–æ–¥ API
parameters: Any # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞  
 errors: Any # –û—à–∏–±–∫–∏ (—Å–ø–∏—Å–æ–∫/—Å–ª–æ–≤–∞—Ä—å)
results: int # –ö–æ–ª-–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
response: Any # –î–∞–Ω–Ω—ã–µ (—Å–ø–∏—Å–æ–∫/—Å–ª–æ–≤–∞—Ä—å)

class PagedAPIResponse(APIResponse):
"""–î–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏"""
paging: Dict[str, int]

üåç –°—Ç—Ä–∞–Ω—ã –∏ –ª–∏–≥–∏
python
class Country(BaseModel): # –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã
class CountriesResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∞–º–∏

class LeagueCountry(BaseModel): # –°—Ç—Ä–∞–Ω–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ª–∏–≥–∏
class Season(BaseModel): # –°–µ–∑–æ–Ω –ª–∏–≥–∏ (—Å coverage)
class League(BaseModel): # –î–∞–Ω–Ω—ã–µ –ª–∏–≥–∏ + —Å–µ–∑–æ–Ω—ã
class LeaguesResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å –ª–∏–≥–∞–º–∏

‚öΩ –ö–æ–º–∞–Ω–¥—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
python
class TeamCountry(BaseModel): # –°—Ç—Ä–∞–Ω–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–æ–º–∞–Ω–¥—ã  
class Team(BaseModel): # –î–∞–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
class TeamsResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å –∫–æ–º–∞–Ω–¥–∞–º–∏

class TeamStatistics(BaseModel): # –ü–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –∑–∞ —Å–µ–∑–æ–Ω
class StatisticsResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

üë• –ò–≥—Ä–æ–∫–∏
python
class Player(BaseModel): # –î–∞–Ω–Ω—ã–µ –∏–≥—Ä–æ–∫–∞
class PlayersResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å –∏–≥—Ä–æ–∫–∞–º–∏

üèÄ –ò–≥—Ä—ã –∏ –º–∞—Ç—á–∏
python
class GameTeam(BaseModel): # –ö–æ–º–∞–Ω–¥–∞ –≤ –∏–≥—Ä–µ
class GameTeams(BaseModel): # –î–≤–µ –∫–æ–º–∞–Ω–¥—ã (home/away)
class GameScores(BaseModel): # –°—á–µ—Ç –ø–æ —á–µ—Ç–≤–µ—Ä—Ç—è–º
class GameStatus(BaseModel): # –°—Ç–∞—Ç—É—Å –∏–≥—Ä—ã
class GameLeague(BaseModel): # –õ–∏–≥–∞ –∏–≥—Ä—ã
class GameCountry(BaseModel): # –°—Ç—Ä–∞–Ω–∞ –∏–≥—Ä—ã
class Game(BaseModel): # –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã
class GamesResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å –∏–≥—Ä–∞–º–∏

üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
python
class ShootingStats(BaseModel): # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—Ä–æ—Å–∫–æ–≤
class ReboundsStats(BaseModel): # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–±–æ—Ä–æ–≤

class TeamGameStats(BaseModel): # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏–≥—Ä–µ
class TeamsStatisticsResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∫–æ–º–∞–Ω–¥

class PlayerGameStats(BaseModel): # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏–≥—Ä–µ  
class PlayersStatisticsResponse(APIResponse) # –û—Ç–≤–µ—Ç —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏–≥—Ä–æ–∫–æ–≤

üîß –£—Ç–∏–ª–∏—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
handle_null_strings() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ null –≤ —Å—Ç—Ä–æ–∫–∞—Ö
handle_null_dates() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ null –≤ –¥–∞—Ç–∞—Ö
normalize_season() - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–∑–æ–Ω–∞ –≤ —Å—Ç—Ä–æ–∫—É
handle_null_country() - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä–∞–Ω—ã

**–§–∞–π–ª:** `data-collector/src/main.py`

üìã –î–∞–π–¥–∂–µ—Å—Ç: main.py - FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
python
app = FastAPI() # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
basketball_api = None # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç API
data_orchestrator = None # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
üîß –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
python
@app.on_event("startup") # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞
@app.on_event("shutdown") # –û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤

üìä –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
python

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–±–æ—Ä–æ–º

POST /collection/start # –ó–∞–ø—É—Å–∫ —Å–±–æ—Ä–∞
POST /collection/stop # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–±–æ—Ä–∞  
GET /collection/status # –°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∞
POST /collection/historical # –†—É—á–Ω–æ–π —Å–±–æ—Ä –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

üåê –ü—Ä–æ–∫—Å–∏-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –∫ Basketball API
python

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API

GET /seasons # –í—Å–µ —Å–µ–∑–æ–Ω—ã
GET /countries # –°—Ç—Ä–∞–Ω—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
GET /leagues # –õ–∏–≥–∏ (—Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ)
GET /teams # –ö–æ–º–∞–Ω–¥—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
GET /statistics # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –∑–∞ —Å–µ–∑–æ–Ω
GET /players # –ò–≥—Ä–æ–∫–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
GET /games # –ú–∞—Ç—á–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä
python
GET /games/statistics/teams # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ –∏–≥—Ä–∞–º (–¥–æ 20 –∏–≥—Ä)
GET /games/statistics/players # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –∏–≥—Ä–∞–º
‚öî Head-to-Head –∞–Ω–∞–ª–∏–∑
python
GET /games/h2h # –ò—Å—Ç–æ—Ä–∏—è –≤—Å—Ç—Ä–µ—á –¥–≤—É—Ö –∫–æ–º–∞–Ω–¥
GET /games/h2h/analysis # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å—Ç—Ä–µ—á # –í–∫–ª—é—á–∞–µ—Ç: –±–∞–∑–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Å—Ç—Ä–µ—á–∏, # –∞–Ω–∞–ª–∏–∑ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∞—Ä–µ–Ω–∞–º

üóÑÔ∏è –†–∞–±–æ—Ç–∞ —Å –ë–î
python
GET /data/leagues # –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–∏–≥/—Å–µ–∑–æ–Ω–æ–≤/–∫–æ–º–∞–Ω–¥ –∏–∑ –ë–î
ü©∫ –°–∏—Å—Ç–µ–º–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
python
GET / # –ö–æ—Ä–Ω–µ–≤–æ–π endpoint
GET /health # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è (API –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)

üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
python
GET /test/database # –¢–µ—Å—Ç –ë–î –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
GET /test/database/simple # –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ë–î
GET /test/database/basic # –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
GET /test/repositories/simple # –¢–µ—Å—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

üîç –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ª–∏–º–∏—Ç–æ–≤
–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API - –ø—Ä–æ–≤–µ—Ä–∫–∞ errors –≤ –æ—Ç–≤–µ—Ç–∞—Ö
–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–∏–≥ - –ø–æ coverage —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (filter_by_stats)
–õ–∏–º–∏—Ç—ã - –º–∞–∫—Å–∏–º—É–º 20 game_ids –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–π–º–∑–æ–Ω

üìù –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
BasketballAPI - –∫–ª–∏–µ–Ω—Ç –≤–Ω–µ—à–Ω–µ–≥–æ API
DataOrchestrator - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
db_manager - –º–µ–Ω–µ–¥–∂–µ—Ä –ë–î
repositories - —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

**–§–∞–π–ª:** `data-collector/src/api/basketball_api.py`

–î–∞–π–¥–∂–µ—Å—Ç: basketball_api.py - API –∫–ª–∏–µ–Ω—Ç

üèóÔ∏è –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å
python
class BasketballAPI:
"""–ö–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Basketball API (api-sports.io)"""
def **init**(self, api_key: str, base_url: str = "https://v1.basketball.api-sports.io")
üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
python
async def test_connection(self) -> bool
"""–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API (/status)"""
üìä –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã API
üìÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
python
async def get_seasons(self) -> Optional[SeasonsResponse]
"""–í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ–∑–æ–Ω—ã"""

async def get_countries(self, country_id, name, code, search) -> Optional[CountriesResponse]
"""–°—Ç—Ä–∞–Ω—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
üèÜ –õ–∏–≥–∏
python
async def get_leagues(self, league_id, name, country_id, country, type, season, search, code, filter_by_stats_coverage=True) -> Optional[LeaguesResponse]
"""–õ–∏–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π + —Ñ–∏–ª—å—Ç—Ä –ø–æ coverage —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏""" # –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ª–∏–≥–∏ –ø–æ –Ω–∞–ª–∏—á–∏—é –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚öΩ –ö–æ–º–∞–Ω–¥—ã
python
async def get_teams(self, team_id, name, country_id, country, league, season, search) -> Optional[TeamsResponse]
"""–ö–æ–º–∞–Ω–¥—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π (—Ç—Ä–µ–±—É–µ—Ç —Ö–æ—Ç—è –±—ã 1 –ø–∞—Ä–∞–º–µ—Ç—Ä)"""
üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
python
async def get_team_statistics(self, league, season, team, date) -> Optional[StatisticsResponse]
"""–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –∑–∞ —Å–µ–∑–æ–Ω"""

async def get_teams_statistics(self, game_id, game_ids) -> Optional[TeamsStatisticsResponse]
"""–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ –∏–≥—Ä–∞–º (–º–∞–∫—Å. 20 game_ids)"""

async def get_players_statistics(self, game_id, game_ids, player, season) -> Optional[PlayersStatisticsResponse]
"""–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –ø–æ –∏–≥—Ä–∞–º (player —Ç—Ä–µ–±—É–µ—Ç season)"""
üë• –ò–≥—Ä–æ–∫–∏
python
async def get_players(self, player_id, team, season, search) -> Optional[PlayersResponse]
"""–ò–≥—Ä–æ–∫–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π"""
üèÄ –ò–≥—Ä—ã
python
async def get_games(self, game_id, date, league, season, team, timezone) -> Optional[GamesResponse]
"""–ú–∞—Ç—á–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π (league —Ç—Ä–µ–±—É–µ—Ç season)"""

async def get_head_to_head(self, team1_id, team2_id, date, league, season, timezone) -> Optional[GamesResponse]
"""–ò—Å—Ç–æ—Ä–∏—è –≤—Å—Ç—Ä–µ—á –¥–≤—É—Ö –∫–æ–º–∞–Ω–¥ (—á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä h2h)"""
‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
python
async def close(self)
"""–ó–∞–∫—Ä—ã—Ç–∏–µ HTTP –∫–ª–∏–µ–Ω—Ç–∞"""
üîç –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è endpoints

–ú–∞–∫—Å–∏–º—É–º 20 game_ids –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–í–∑–∞–∏–º–æ–∑–∞–≤–∏—Å–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (league ‚Üí season, player ‚Üí season)

–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–∏–≥:

filter_by_stats_coverage=True - –æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –ª–∏–≥–∏ —Å –ø–æ–ª–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç coverage.games.statistics.teams –∏ coverage.games.statistics.players

–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ structlog
–í–æ–∑–≤—Ä–∞—Ç None –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö (–≤–º–µ—Å—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–π)
–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –æ—à–∏–±–æ–∫

–¢–∏–ø–∏–∑–∞—Ü–∏—è:
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç Pydantic –º–æ–¥–µ–ª–∏ –∏–∑ basketball_models.py
–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

üìù –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
httpx.AsyncClient - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã

structlog - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–§–∞–π–ª:** `data-collector/src/storage/database.py`

üìã –î–∞–π–¥–∂–µ—Å—Ç: database.py - –ú–æ–¥–µ–ª–∏ –ë–î
üèóÔ∏è –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
python
class Base(DeclarativeBase): # –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π
class DatabaseManager: # –ú–µ–Ω–µ–¥–∂–µ—Ä –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –ë–î
üóÑÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏
üèÜ –õ–∏–≥–∏ –∏ —Å–µ–∑–æ–Ω—ã
python
class League(Base):
"""–õ–∏–≥–∏: id, name, type, logo, country_data""" # –°–≤—è–∑–∏: seasons, games

class Season(Base):  
 """–°–µ–∑–æ–Ω—ã: league_id, season, dates, coverage_flags""" # –°–≤—è–∑–∏: league, games, team_stats # Coverage: has_teams_stats, has_players_stats, has_standings, has_odds
‚öΩ –ö–æ–º–∞–Ω–¥—ã
python
class Team(Base):
"""–ö–æ–º–∞–Ω–¥—ã: id, name, code, country, founded, logo, national""" # –°–≤—è–∑–∏: home_games, away_games, team_stats, player_stats
üèÄ –ò–≥—Ä—ã –∏ –º–∞—Ç—á–∏
python
class Game(Base):
"""–ò–≥—Ä—ã: league_id, season_id, teams, date, scores, status""" # –î–µ—Ç–∞–ª—å–Ω—ã–π —Å—á–µ—Ç –ø–æ —á–µ—Ç–≤–µ—Ä—Ç—è–º + OT # –°–≤—è–∑–∏: league, season, home_team, away_team, team_stats, player_stats
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥
python
class TeamSeasonStats(Base):
"""–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –∑–∞ —Å–µ–∑–æ–Ω: –∏–≥—Ä—ã, –ø–æ–±–µ–¥—ã, –æ—á–∫–∏, –ø—Ä–æ—Ü–µ–Ω—Ç—ã""" # –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –≤–µ—Å—å —Å–µ–∑–æ–Ω

class TeamGameStats(Base):
"""–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥—ã –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏–≥—Ä–µ: –±—Ä–æ—Å–∫–∏, –ø–æ–¥–±–æ—Ä—ã, –ø–µ—Ä–µ–¥–∞—á–∏""" # –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –∏–≥—Ä—É: FG%, 3P%, FT%, rebounds, assists, etc.
üë• –ò–≥—Ä–æ–∫–∏ –∏ –∏—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
python
class Player(Base):
"""–ò–≥—Ä–æ–∫–∏: id, name, personal_data, position""" # –°–≤—è–∑–∏: game_stats

class PlayerGameStats(Base):
"""–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ –≤ –∏–≥—Ä–µ: –º–∏–Ω—É—Ç—ã, –±—Ä–æ—Å–∫–∏, –æ—á–∫–∏, –¥—Ä—É–≥–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏""" # player_type: "starters" –∏–ª–∏ "bench"
üí∞ –ë–µ—Ç—Ç–∏–Ω–≥ –¥–∞–Ω–Ω—ã–µ
python
class Odds(Base):
"""–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã: game_id, bookmaker, –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ—ç—Ñ—ã, —Ç–æ—Ç–∞–ª—ã, —Ñ–æ—Ä—ã""" # odds_home, odds_away, total_over, total_under, handicap
üîÑ –°–∏—Å—Ç–µ–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è
üéØ –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥
python
class TeamAlias(Base):
"""–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—à–∏—Ö –∫–æ–º–∞–Ω–¥ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ (Betcity)""" # team_id (–Ω–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞), betcity_name, confidence (0-1)
üèÜ –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ª–∏–≥
python
class LeagueMapping(Base):
"""–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—à–∏—Ö –ª–∏–≥ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏""" # league_id (–Ω–∞—à–∞ –ª–∏–≥–∞), betcity_league_id, betcity_league_name
‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î
python
class DatabaseManager:
"""–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä PostgreSQL –ë–î"""
async def create_tables(self) # –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
def get_async_session(self) # –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Å—Å–∏–∏
üîç –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è asyncpg –¥–ª—è PostgreSQL

–°–≤—è–∑–∏ SQLAlchemy - –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ —á–µ—Ä–µ–∑ relationship

–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ–∑–æ–Ω–Ω—É—é –∏ –ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω—É—é

–°–∏—Å—Ç–µ–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è - TeamAlias –∏ LeagueMapping –¥–ª—è —Å–≤—è–∑–∏ —Å –±–µ—Ç—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏

–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ - created_at, updated_at –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

Coverage —Å–∏—Å—Ç–µ–º–∞ - —Ñ–ª–∞–≥–∏ –¥–æ—Å—Ç—É–ø–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ Season

üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
–û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏: League ‚Üí Season ‚Üí Team ‚Üí Game

–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: TeamSeasonStats (–∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è), TeamGameStats/PlayerGameStats (–¥–µ—Ç–∞–ª—å–Ω–∞—è)

–ë–µ—Ç—Ç–∏–Ω–≥: Odds (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã)

–°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ: TeamAlias, LeagueMapping (–¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

### –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

**–ü–∞–ø–∫–∞:** `data-collector/src/storage/repositories/`

- `league_repository.py`, `team_repository.py`, `game_repository.py`
- `alias_repository.py` - —Ç–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è

## üìä –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –ü–†–û–ï–ö–¢–ê

**‚úÖ –ó–ê–í–ï–†–®–ï–ù–û:**

- Data-collector —Å –ø–æ–ª–Ω—ã–º API –∫–ª–∏–µ–Ω—Ç–æ–º
- –ú–æ–¥–µ–ª–∏ –ë–î (–Ω–µ –≤—Å–µ) –∏ Pydantic —Å—Ö–µ–º—ã
- –ë–∞–∑–æ–≤—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

**üî® –í –†–ê–ó–†–ê–ë–û–¢–ö–ï:**

- –°–∏—Å—Ç–µ–º–∞ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥/–ª–∏–≥ —Å –±–µ—Ç—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
- –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ API –∏ –ø–∞—Ä—Å–µ—Ä–∞
- –°–±–æ—Ä –≤—Å–µ—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –≤—Å–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º –ª–∏–≥–∞–º
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–¥–∞–Ω–∏–π –ø–æ —Å–±–æ—Ä—É –º–∞—á—Ç–µ–π –∏ –∫—ç—Ñ–æ–≤ –Ω–∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–¥–∞–Ω–∏–π –ø–æ —Å–±–æ—Ä—É –ª–∞–π–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —á–µ—Ç–≤–µ—Ä—Ç—è–º

**üìã –í –ü–õ–ê–ù–ò–†–û–í–ê–ù–ò–ò:**

- ML –º–æ–¥—É–ª—å –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
